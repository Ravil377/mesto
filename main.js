(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{hi:()=>Z,U_:()=>$,iS:()=>et});var e={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__container-submit-button",inactiveButtonClass:"popup__container-submit-button_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},n=document.querySelector(".profile__edit-button"),o=document.querySelector(".profile__add-button"),r=document.querySelector(".profile__info"),i=r.querySelector(".profile__title-text"),u=r.querySelector(".profile__subtitle"),a=(document.querySelector(".profile__avatar"),document.querySelector(".popup_edit-profile")),c=a.querySelector(".popup__input_type_name"),s=a.querySelector(".popup__input_type_info"),l=a.querySelector(".edit-profile"),f=document.querySelector(".popup_add-card").querySelector(".add-card"),p=document.querySelector(".profile__avatar-overlay"),h=document.querySelector(".edit-avatar");function _(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var d=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popup=document.querySelector(e),this._popupButtonClose=this._popup.querySelector(".popup__button-close"),this._handleEscClose=this._handleEscClose.bind(this)}var e,n;return e=t,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){document.removeEventListener("keydown",this._handleEscClose),this._popup.classList.remove("popup_opened")}},{key:"_handleEscClose",value:function(t){"Escape"===t.code&&this.close()}},{key:"_handleOverlayClose",value:function(t){t.target===this._popup&&this.close()}},{key:"setEventListeners",value:function(){this._popupButtonClose.addEventListener("click",this.close.bind(this)),this._popup.addEventListener("click",this._handleOverlayClose.bind(this))}}])&&_(e.prototype,n),t}();function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function m(t,e,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function k(t,e){return!e||"object"!==y(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(u,t);var e,n,o,r,i=(o=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(o);if(r){var n=g(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return k(this,t)});function u(t,e,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,t))._confirmSubmit=n,o._confirmButton=o._popup.querySelector(e),o._id="",o._handleCardDelete="",o}return e=u,(n=[{key:"open",value:function(t,e){m(g(u.prototype),"open",this).call(this),this._id=t,this._handleCardDelete=e}},{key:"setEventListeners",value:function(){var t=this;m(g(u.prototype),"setEventListeners",this).call(this),this._confirmButton.addEventListener("click",(function(){t._confirmSubmit(t._id,t._handleCardDelete),t.close()}))}}])&&v(e.prototype,n),u}(d);function E(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var C,w,O,j=function(){function t(e,n,o,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e.name,this._alt=e.name,this._link=e.link,this._userId=e.owner._id,this._id=e._id,this._likes=e.likes,this._cardSelector=n,this._handleCardClick=o,this._handleCardDelete=r,this._handleLikeCount=i,this._element=this._getTemplate(this._cardSelector),this._removeButton=this._element.querySelector(t.selectors.removeButton),this._likeButton=this._element.querySelector(t.selectors.likeButton),this._imageButton=this._element.querySelector(t.selectors.imageButton),this._cardText=this._element.querySelector(t.selectors.text),this._likeCount=this._element.querySelector(t.selectors.likeCount)}var e,n;return e=t,(n=[{key:"_handleLikeClick",value:function(){return this._likeButton.classList.toggle(t.selectors.likeButtonActive)}},{key:"addAndRemoveLike",value:function(t){this._likeCount.textContent=t}},{key:"_setEventListeners",value:function(){var e=this;"997905c6446d826c7cb080d1"===this._userId&&this._removeButton.addEventListener("click",(function(){e._handleCardDelete(e._id,e._removeButton.closest(t.selectors.card))})),this._likeButton.addEventListener("click",(function(){var t=e._handleLikeClick(e);e._handleLikeCount(t,e._id)})),this._imageButton.addEventListener("click",(function(){e._handleCardClick(e._name,e._link)}))}},{key:"_getTemplate",value:function(e){var n=document.querySelector(e).content.cloneNode(!0);return this._cardElement=n,"997905c6446d826c7cb080d1"!=this._userId&&this._cardElement.querySelector(t.selectors.removeButton).remove(),this._cardElement}},{key:"generateCard",value:function(){var e=this;return this._imageButton.alt=this._alt,this._imageButton.src=this._link,this._cardText.textContent=this._name,this._likeCount.textContent=this._likes.length,this._likes.forEach((function(n){"997905c6446d826c7cb080d1"===n._id&&e._likeButton.classList.add(t.selectors.likeButtonActive)})),this._setEventListeners(),this._element}}])&&E(e.prototype,n),t}();function L(t){var e=new j(t,".element-template",(function(t,e){et.open(t,e)}),(function(t,e){$.open(t,e)}),(function(t,n){t?Z.likeAdd(n).then((function(t){return e.addAndRemoveLike(t.likes.length)})).catch((function(t){return console.log(t)})):Z.deleteLike(n).then((function(t){return e.addAndRemoveLike(t.likes.length)})).catch((function(t){return console.log(t)}))}));return e.generateCard()}function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function I(t,e,n){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function q(t,e){return(q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function R(t,e){return!e||"object"!==P(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}O={text:".element__title",removeButton:".element__delete-button",likeButton:".element__like-button",likeButtonActive:"element__like-button_active",imageButton:".element__image",card:".element",popup:".popup_gallery",likeCount:".element__like-count"},(w="selectors")in(C=j)?Object.defineProperty(C,w,{value:O,enumerable:!0,configurable:!0,writable:!0}):C[w]=O;var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&q(t,e)}(u,t);var e,n,o,r,i=(o=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=T(o);if(r){var n=T(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return R(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t))._fullImage=e._popup.querySelector(".full-image__image"),e._fullImageCaption=e._popup.querySelector(".full-image__caption"),e}return e=u,(n=[{key:"open",value:function(t,e){I(T(u.prototype),"open",this).call(this),this._fullImage.src=e,this._fullImageCaption.alt=t,this._fullImageCaption.textContent=t}}])&&B(e.prototype,n),u}(d);function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function z(t,e,n){return(z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=N(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function V(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function N(t){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var J=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D(t,e)}(u,t);var e,n,o,r,i=(o=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=N(o);if(r){var n=N(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return V(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t))._formSubmit=e,n._form=n._popup.querySelector(".form"),n._inputList=n._form.querySelectorAll(".popup__input"),n._buttonSubmit=n._popup.querySelector(".popup__container-submit-button"),n}return e=u,(n=[{key:"_getInputValues",value:function(){var t=this;return this._formValues={},this._inputList.forEach((function(e){t._formValues[e.name]=e.value})),this._formValues}},{key:"close",value:function(){var t=this;z(N(u.prototype),"close",this).call(this),setTimeout((function(){t._form.reset(),t._buttonSubmit.textContent="Сохранить"}),400)}},{key:"setEventListeners",value:function(){var t=this;z(N(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(){t._formSubmit(t._getInputValues()),t._buttonSubmit.textContent="Сохранение..."}))}}])&&U(e.prototype,n),u}(d);function H(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var M=function(){function t(e,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e,this._about=n,this._avatar=document.querySelector(o)}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,about:this._about.textContent,avatar:this._avatar.src}}},{key:"setUserInfo",value:function(t,e){this._name.textContent=t,this._about.textContent=e}},{key:"setUserAvatar",value:function(t){this._avatar.src=t}}])&&H(e.prototype,n),t}();function F(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var G=function(){function t(e,n){var o=e.data,r=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._renderedItems=o,this._renderer=r,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"renderer",value:function(){var t=this;this._renderedItems.forEach((function(e){t.addItem(t._renderer(e))}))}},{key:"addItem",value:function(t){this._container.append(t)}}])&&F(e.prototype,n),t}();function K(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Q=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._options=e}var e,n;return e=t,(n=[{key:"getProfileInfo",value:function(){return fetch("".concat(this._options.baseUrl,"/users/me"),{headers:{authorization:"".concat(this._options.authorization)}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"postProfileInfo",value:function(t,e){return fetch("".concat(this._options.baseUrl,"/users/me"),{method:"PATCH",headers:{authorization:"".concat(this._options.authorization),"Content-Type":"application/json"},body:JSON.stringify({name:t,about:e})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"postProfileAvatar",value:function(t){return fetch("".concat(this._options.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:{authorization:"".concat(this._options.authorization),"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"postCard",value:function(t,e){return fetch("".concat(this._options.baseUrl,"/cards"),{method:"POST",headers:{authorization:"".concat(this._options.authorization),"Content-Type":"application/json"},body:JSON.stringify({name:t,link:e})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"likeAdd",value:function(t){return fetch("".concat(this._options.baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:{authorization:"".concat(this._options.authorization),"Content-Type":"application/json"},body:JSON.stringify({owner:{_id:"997905c6446d826c7cb080d1"}})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"deleteLike",value:function(t){return fetch("".concat(this._options.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:{authorization:"".concat(this._options.authorization),"Content-Type":"application/json"},body:JSON.stringify({owner:{_id:"997905c6446d826c7cb080d1"}})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._options.baseUrl,"/cards"),{headers:{authorization:"".concat(this._options.authorization)}}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"deleteCard",value:function(t){return fetch("".concat(this._options.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:{authorization:"".concat(this._options.authorization),"Content-Type":"application/json"},body:JSON.stringify({owner:{_id:"997905c6446d826c7cb080d1"}})}).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){console.log(t)}))}}])&&K(e.prototype,n),t}();function W(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var X=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._settings=e,this._form=n,this._inputList=Array.from(this._form.querySelectorAll(this._settings.inputSelector)),this._buttonElement=this._form.querySelector(this._settings.submitButtonSelector)}var e,n;return e=t,(n=[{key:"enableValidation",value:function(){this._disableSubmitButton(),this._form.addEventListener("submit",(function(t){t.preventDefault()})),this._setEventListener(this._form)}},{key:"_setEventListener",value:function(){var t=this;this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._checkInputValidity(e),t._toggleButtonState()}))})),this._form.addEventListener("reset",(function(){t._inputList.forEach((function(e){t._hideInputError(e)})),t._disableSubmitButton()}))}},{key:"_checkInputValidity",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}},{key:"_showInputError",value:function(t,e){var n=this._form.querySelector(".".concat(t.id,"-error"));t.classList.add(this._settings.inputErrorClass),n.textContent=e,n.classList.add(this._settings.errorClass)}},{key:"_hideInputError",value:function(t){var e=this._form.querySelector(".".concat(t.id,"-error"));t.classList.remove(this._settings.inputErrorClass),e.classList.remove(this._settings.errorClass),e.textContent=""}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(t){return!t.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._disableSubmitButton(),this._hasInvalidInput(this._inputList)?this._disableSubmitButton():(this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.remove(this._settings.inactiveButtonClass))}},{key:"_disableSubmitButton",value:function(){this._buttonElement.setAttribute("disabled",!0),this._buttonElement.classList.add(this._settings.inactiveButtonClass)}}])&&W(e.prototype,n),t}(),Y=new M(i,u,".profile__avatar"),Z=new Q({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-24",authorization:"ebb98a36-70e4-466a-8500-5c6ce9301133"});Z.getProfileInfo().then((function(t){Y.setUserInfo(t.name,t.about),Y.setUserAvatar(t.avatar)})).catch((function(t){return console.log(t)}));var $=new S(".popup_imageDelete",".popup__container-submit-button_delete-button",(function(t,e){Z.deleteCard(t).then((function(t){e.remove()})).catch((function(t){return console.log(t)}))}));$.setEventListeners(),Z.getInitialCards().then((function(t){new G({data:t,renderer:function(t){return L(t)}},".elements").renderer()}));var tt=new J(".popup_add-card",(function(t){Z.postCard(t.name,t.link).then((function(t){new G({data:t,renderer:function(t){return L(t)}},".elements").addItem(L(t))})).catch((function(t){return console.log(t)})).finally((function(){tt.close()}))}));tt.setEventListeners(),o.addEventListener("click",(function(){tt.open()}));var et=new x(".popup_gallery");et.setEventListeners();var nt=new J(".popup_edit-profile",(function(t){Z.postProfileInfo(t.name,t.about).then((function(t){return Y.setUserInfo(t.name,t.about)})).catch((function(t){return console.log(t)})).finally((function(){nt.close()}))}));nt.setEventListeners();var ot=new J(".popup_avatar",(function(t){Z.postProfileAvatar(t.avatar).then((function(t){return Y.setUserAvatar(t.avatar)})).catch((function(t){return console.log(t)})).finally((function(){ot.close()}))}));ot.setEventListeners(),n.addEventListener("click",(function(){var t=Y.getUserInfo();c.value=t.name,s.value=t.about,nt.open()})),p.addEventListener("click",(function(){ot.open()}));var rt=new X(e,h),it=new X(e,l),ut=new X(e,f);it.enableValidation(),ut.enableValidation(),rt.enableValidation()})();